<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Web2App Generator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes fadeIn{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}
    .fadeIn{animation:fadeIn .6s ease forwards}
    .spinner{width:24px;height:24px;border:3px solid #e5e7eb;border-top:3px solid #3b82f6;border-radius:50%;animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
  </style>
</head>
<body class="bg-slate-100 text-slate-800 font-sans">

<main class="max-w-3xl mx-auto px-4 py-20">
  <div class="text-center mb-10">
    <h1 class="text-4xl md:text-5xl font-bold fadeIn">Web2App Generator</h1>
    <p class="mt-2 text-slate-500">Ubah website jadi APK Android dalam 1 klik.</p>
  </div>

  <!-- Form -->
  <form id="generatorForm" class="bg-white p-6 md:p-8 rounded-2xl shadow-2xl fadeIn">
    <label class="block mb-2 font-semibold">URL Website</label>
    <input id="url" type="url" required placeholder="https://example.com"
      class="w-full p-3 rounded-md bg-slate-100 border border-transparent focus:ring focus:ring-blue-500 outline-none"/>

    <label class="block mt-4 mb-2 font-semibold">Email (opsional)</label>
    <input id="email" type="email" placeholder="you@domain.com"
      class="w-full p-3 rounded-md bg-slate-100 border border-transparent focus:ring focus:ring-blue-500 outline-none"/>

    <label class="block mt-4 mb-2 font-semibold">Nama Aplikasi</label>
    <input id="appName" type="text" required placeholder="MyApp"
      class="w-full p-3 rounded-md bg-slate-100 border border-transparent focus:ring focus:ring-blue-500 outline-none"/>

    <button type="submit"
      class="w-full mt-6 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-md flex items-center justify-center gap-2">
      <span id="btnText">Generate APK</span>
      <div id="spinner" class="spinner hidden"></div>
    </button>
  </form>

  <!-- Progress -->
  <div id="progressBox" class="hidden mt-6">
    <div class="w-full bg-slate-200 rounded-full h-2.5">
      <div id="progressBar" class="bg-blue-500 h-2.5 rounded-full transition-all duration-300" style="width:0%"></div>
    </div>
    <p id="progressText" class="text-center text-sm mt-2 text-slate-500">Mempersiapkan...</p>
  </div>

  <!-- Alert -->
  <div id="alertBox" class="hidden mt-6 p-4 rounded-lg text-white font-semibold"></div>

  <!-- Download button (muncul setelah selesai) -->
  <div id="downloadBox" class="hidden mt-6 text-center">
    <a id="downloadBtn" href="#" download
      class="inline-flex items-center gap-2 bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-md transition-transform hover:scale-105">
      <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l.707.707L15.5 5.086V12h1V5.086l2.793-2.379L20.5 4.5 12 13 3.5 4.5l1.707-1.707L8 5.086V12h1V5.086L11.293 2.707 12 2zM4 14v8h16v-8h2v10H2V14h2z"/></svg>
      Download APK
    </a>
  </div>
</main>

<script>
const form = document.getElementById('generatorForm');
const btnText = document.getElementById('btnText');
const spinner = document.getElementById('spinner');
const progressBox = document.getElementById('progressBox');
const progressBar = document.getElementById('progressBar');
const progressText = document.getElementById('progressText');
const alertBox = document.getElementById('alertBox');
const downloadBox = document.getElementById('downloadBox');
const downloadBtn = document.getElementById('downloadBtn');

function showAlert(msg, type='success'){
  alertBox.className=`mt-6 p-4 rounded-lg text-white font-semibold ${type==='success'?'bg-green-500':'bg-red-500'}`;
  alertBox.textContent=msg;
  alertBox.classList.remove('hidden');
}

form.onsubmit = async (e)=>{
  e.preventDefault();
  btnText.textContent='Generating...';
  spinner.classList.remove('hidden');
  progressBox.classList.remove('hidden');
  alertBox.classList.add('hidden');
  downloadBox.classList.add('hidden');

  const url=document.getElementById('url').value.trim();
  const email=document.getElementById('email').value.trim();
  const name=document.getElementById('appName').value.trim();

  let w=0;
  const prog=setInterval(()=>{
    w+=4;
    progressBar.style.width=`${w}%`;
    progressText.textContent=w<30?'Mengunduh resource...':w<70?'Compiling APK...':'Finalizing...';
    if(w>=100)clearInterval(prog);
  },100);

  try{
    const res = await fetch('https://web2apk-cg.zone.id/tools/web2app?apikey=bagus',{
      method:'POST',
      headers:{'Content-Type':'application/x-www-form-urlencoded'},
      body:new URLSearchParams({url,email,name})
    });
    if(!res.ok) throw new Error(`HTTP ${res.status}`);
    const data=await res.json();
    if(data.status){
      clearInterval(prog);
      progressBar.style.width='100%';
      progressText.textContent='Selesai!';
      downloadBtn.href=data.download;
      downloadBox.classList.remove('hidden');
      showAlert('APK berhasil dibuat! Klik tombol di bawah.');
    }else{
      throw new Error(data.message || 'Server gagal membuat APK');
    }
  }catch(err){
    clearInterval(prog);
    console.error(err);
    showAlert(err.message,'error');
  }finally{
    btnText.textContent='Generate APK';
    spinner.classList.add('hidden');
    setTimeout(()=>progressBox.classList.add('hidden'),1500);
  }
}
</script>
</body>
</html>
